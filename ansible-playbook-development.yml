# This playbook installs apps and packages needed for general development
- hosts: localhost
  pre_tasks:
    - name: Stow dotfiles for ack
      command: stow ack
      changed_when: false
    - name: Stow dotfiles for Git
      command: stow git
      changed_when: false
    - name: Stow dotfiles for Neovim
      command: stow neovim
      changed_when: false
    - name: Stow dotfiles for Oh My Zsh
      command: stow zsh
      changed_when: false
  roles:
    - geerlingguy.homebrew
  vars:
    homebrew_taps:
      - getantibody/tap
      - homebrew/cask
    homebrew_installed_packages:
      - ack
      - antibody
      - bat
      - coreutils
      - fd
      - fdupes
      - ffmpeg
      - git
      - go
      - grep
      - gron
      - hub
      - imagemagick
      - imagesnap
      - jq
      - neovim
      - nmap
      - nnn
      - node
      - pipes-sh
      - python3
      - shellcheck
      - thefuck
      - tidy-html5
      - tldr
      - tokei
      - trash
      - tree
      - uncrustify
      - wallpaper
      - watch
      - wifi-password
      - zsh
    homebrew_uninstalled_packages:
      - excel-compare
      - gist
      - mono
      - nvm
      - shpotify
    homebrew_cask_apps:
      - colorpicker-skalacolor
      - couleurs
      - docker
      - goland
      - kitematic
      - postman
      - qlmarkdown
      - qlstephen
    homebrew_cask_uninstalled_apps:
      - clion
      - dotnet
  tasks:
    - pip:
        name: neovim
    - name: Install nvim plugins
      command: nvim --headless +GoUpdateBinaries +PlugUpdate +PlugUpgrade +qall
      changed_when: false
    - name: Install vim-plug
      command: curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
      changed_when: false
    - name: Install Node.js packages
      command: npm install -g js-beautify prettydiff typescript typescript-formatter
    - name: Install Oh My Zsh
      command: sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
      register: result
      changed_when: result.stdout is not search("You already have Oh My Zsh installed.")
